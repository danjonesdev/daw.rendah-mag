(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{153:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),c=a(22),l=a(2),s=a(0),o=a.n(s),i=a(58),m=a.n(i),u=a(10),p=a(59),f=a.n(p),v=a(9),d=a.n(v),g=function(e,t,a,n){var r,c=t,l=[];!function e(t,n){if(t["".concat(a)]===n&&d()(c,t))return t;var r,s;for(s in t)if(t.hasOwnProperty(s)&&"object"===typeof t[s]&&(r=e(t[s],n)))return l.push(s),r;return r}(e,c[a]);var s=function(e,t){var l=t.pop();if(r=t.reduce(function(e,t){return e[t]},e)[l],d()(c,r))return r[a]=n,e}(e,f()(l));return console.log("mutatedSource",s),s},E=Object(u.createConnectedStore)({settings:"dummy val",loops:"dummy val",cueLoop:"dummy val",functions:"dummy val"}),h=a(21),b=a(6),w=a.n(b);a(26);var _=function(e){var t=Object(s.useState)(null),a=Object(l.a)(t,2),n=a[0],r=a[1],c=Object(s.useState)(!1),i=Object(l.a)(c,2),m=i[0],u=(i[1],E.useStore()),p=u.get("cueLoop"),f=u.get("loops");u.get("settings"),Object(s.useEffect)(function(){if(e.effects&&e.effects.length)v();else{var t=new w.a({source:e.file});r(t)}},[e]);var v=function(){var t;for(t=0;t<e.effects.length;t++){var a=e.effects[t],n={};for(var c in a.properties)a.properties.hasOwnProperty(c)&&"_unique"!==c&&(n[c]=a.properties[c]/10);var l=new w.a(Object(h.a)({source:e.file},a.name,n));r(l)}};return n?o.a.createElement("div",{className:"col-24  session-view__channel__pad-wrapper"},o.a.createElement("div",{className:"col-24  session-view__channel__pad",onClick:function(){if(n.play(),p.isLooping){var t={name:e.name,file:e.file,effects:e.effects,timeStamp:performance.now(),timeFromStartOfLoop:p.loopRestarted?performance.now()-p.loopRestarted:0};if(!f.length){var a={active:!0,startTime:performance.now(),endTime:null,duration:null,loopCompleted:!1,timeline:[t]};return void f.push(a)}if(f[f.length-1].loopCompleted){var r={active:!0,startTime:performance.now(),endTime:null,duration:null,loopCompleted:!1,timeline:[t]};return void f.push(r)}f[f.length-1].timeline.push(t)}}},o.a.createElement("div",{className:"flex  flex-wrap  align-center  justify-center  h-100"},"sample ",e.name))):!!m&&o.a.createElement("div",{className:"col-24  sample-pad-wrapper"},o.a.createElement("div",{className:"flex  flex-wrap  sample-pad"},"error: ",e.name))};var x=function(e){return o.a.createElement("div",{className:"col-6  session-view__channel"},o.a.createElement("div",{className:"flex  flex-wrap  h-100"},e.samples.map(function(e){if(e.active)return o.a.createElement(_,e)})))};var j=function(){var e=E.useStore().get("settings");return!!e.categories&&o.a.createElement("div",{className:"w-100  flex  flex-wrap  session-view"},e.categories.map(function(e){return o.a.createElement(x,e)}))};var O=function(e){return o.a.createElement("div",{className:"modal  ".concat(e.type," ").concat(e.isActive?"is-active":"")},o.a.createElement("div",{className:"modal__header"},o.a.createElement("span",{className:"black  modal__header__close",onClick:e.toggleModal},"x"),o.a.createElement("h2",{class:"tac  mla  mra  pt3  black"},e.title)),o.a.createElement("div",{className:"modal__body"},e.children))};var y=function(e){var t=E.useStore(),a=t.get("settings"),n=t.get("functions").mutateObject,r=function(r){r.persist(),t.set("settings")(n(a,e.effect.properties,r.target.name,r.target.value))};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"col-4"},e.effect.name),o.a.createElement("div",{className:"col-20"},function(){var t=[],a=e.effect.properties;for(var n in a)a.hasOwnProperty(n)&&"_unique"!==n&&t.push(o.a.createElement("div",{className:"col-24  flex  flex-wrap  pv1"},o.a.createElement("div",{className:"col-12"},n," ",Math.round(a[n])),o.a.createElement("div",{className:"col-12"},o.a.createElement("input",{onChange:r,name:n,type:"range",min:"0",max:"10",value:Math.round(a[n])}))));return o.a.createElement("div",{className:"flex  flex-wrap"},t)}()))};var N=function(e){var t=Object(s.useState)(!1),a=Object(l.a)(t,2),n=a[0],r=a[1],c=function(){r(!n)},i=E.useStore();return o.a.createElement("div",{class:"col-24  flex  flex-wrap  track-bar__item__modal__row"},o.a.createElement("div",{className:"col-2  flex  align-center"},o.a.createElement("label",{class:"switch",for:"".concat(e.sample.name,"-toggle")},o.a.createElement("input",{type:"checkbox",id:"".concat(e.sample.name,"-toggle"),checked:e.sample.active,name:"".concat(e.sample.name,"-toggle"),onChange:function(){i.set("settings")(g(i.get("settings"),e.sample,"active",!e.sample.active))}}),o.a.createElement("div",{class:"slider round"}))),o.a.createElement("div",{className:"col-10  flex  align-center"},o.a.createElement("p",{className:"black  pl2"},e.sample.name)),o.a.createElement("div",{className:"col-10  flex  flex-wrap"},o.a.createElement("p",{className:"bg-black  white  pa2  dib  f7  shadow2   cp",onClick:c},"Effects"),e.sample.effects&&e.sample.effects.map(function(t){return o.a.createElement(O,{title:"".concat(e.sample.name," Effects"),type:"secondary",isActive:n,toggleModal:c},o.a.createElement(y,{channel:e.channel,sample:e.sample,effect:t}))})))};var k=function(e){var t=E.useStore().get("settings"),a=Object(s.useState)(!1),n=Object(l.a)(a,2),r=n[0],c=n[1],i=function(){c(!r)};return o.a.createElement("div",{className:"col-6  track-bar__item"},o.a.createElement("div",{className:"track-bar__item__modal-trigger-wrapper"},o.a.createElement("div",{className:"flex  flex-wrap  align-center  justify-center  track-bar__item__modal-trigger",onClick:i},e.name)),o.a.createElement(O,{title:"Channel Manager",type:"primary",isActive:r,toggleModal:i},o.a.createElement("div",{className:"w-100  flex  flex-wrap  pv3  ph3"},t.categories.map(function(t){return o.a.createElement(o.a.Fragment,null,t.samples.map(function(a){if(t.name===e.name)return o.a.createElement(N,{channel:t,sample:a})}))}))))};var S=function(){var e=E.useStore().get("settings");return o.a.createElement("div",{className:"w-100  flex  flex-wrap  track-bar"},e.categories.map(function(e){return o.a.createElement(k,e)}))};var C=function(e){var t=Object(s.useState)(e.loop),a=Object(l.a)(t,2),n=a[0],r=(a[1],Object(s.useState)(e.sample)),c=Object(l.a)(r,2),i=c[0],m=(c[1],Object(s.useState)(null)),u=Object(l.a)(m,2),p=u[0],f=u[1],v=Object(s.useState)(!1),d=Object(l.a)(v,2),g=d[0],b=d[1],_=E.useStore(),x=_.get("cueLoop");_.get("loops"),Object(s.useEffect)(function(){if(i.effects&&i.effects.length)j();else{var e=new w.a({source:i.file});f(e)}},[]);var j=function(){var e;for(e=0;e<i.effects.length;e++){var t=i.effects[e],a={};for(var n in t.properties)t.properties.hasOwnProperty(n)&&"_unique"!==n&&(a[n]=t.properties[n]/10);var r=new w.a(Object(h.a)({source:i.file},t.name,a));f(r)}};return!(!i||!p)&&(function(){if(!g){var e=e=i.timeStamp-x.loopTime-(n.timeline[0].timeStamp-x.loopTime);i.timeFromStartOfLoop>0&&(e+=n.timeline[0].timeFromStartOfLoop);var t=function(){setTimeout(function(){console.log("to",performance.now()),p.play()},e)};setInterval(function(){t()},x.loopTime),t(),b(!0)}}(),o.a.createElement("div",{className:"col-24"},o.a.createElement("div",{className:"flex  flex-wrap  align-center  justify-center  h-100"},"sample")))};var L=function(e){var t=Object(s.useState)(e),a=Object(l.a)(t,2),n=a[0];return a[1],!!(n&&n.active&&n.loopCompleted)&&o.a.createElement("div",{className:"col-24"},o.a.createElement("div",{className:"flex  flex-wrap  align-center  justify-center  h-100"},n.timeline.length>0&&n.timeline.map(function(t,a){return o.a.createElement(C,{sample:t,loop:n,loopIndex:e.loopIndex,sampleIndex:a})})))};var T=function(e){var t=Object(s.useState)(!1),a=Object(l.a)(t,2),n=a[0],r=a[1],c=E.useStore(),i=c.get("cueLoop"),m=c.get("loops");return o.a.createElement("div",{onClick:function e(){console.log("from",performance.now());var t=i,a=m;r(!n),t.isLooping=!t.isLooping,a.length&&(t.isLooping||(a[a.length-1].loopCompleted=!0),1===a.length&&(t.loopTime=performance.now()-a[0].startTime,setInterval(function(){t.loopRestarted=performance.now(),t.isLooping&&!a[a.length-1].loopCompleted&&e()},t.loopTime)),c.set("cueLoop")(t),c.set("loops")(a))},className:"col-12  pa2  settings__cue-loop"},o.a.createElement("p",{className:"bg-black  white  pa2  dib  f7  shadow2   cp"},"Cue ","".concat(i.isLooping)),m.length>0&&m.map(function(e,t){if(e.loopCompleted)return o.a.createElement(L,Object.assign({},e,{loopIndex:t}))}))};var I=function(){return o.a.createElement("div",{className:"w-100  flex  flex-wrap  track-bar"},o.a.createElement(T,null))};var M=function(e){var t=E.useStore(),a=t.get("settings"),n=t.get("loops"),r=t.get("cueLoop"),c=t.get("functions");Object(s.useEffect)(function(){t.set("settings")(e.store.settings),t.set("loops")(e.store.loops),t.set("cueLoop")(e.store.cueLoop),t.set("functions")(e.store.functions)},[]);var l=function(e){return"object"===typeof e&&null!==e};return!!(l(a)&&l(n)&&l(r)&&l(c))&&o.a.createElement("div",{className:"flex"},o.a.createElement("div",{className:"col-18  session__track-bar"},o.a.createElement("div",{className:"flex"},o.a.createElement(j,null)),o.a.createElement("div",{className:"flex"},o.a.createElement(S,null))),o.a.createElement("div",{className:"col-6"},o.a.createElement(I,null)))},q=(a(153),a(60)),F=a.n(q)()({projectId:"d5o9qdi6",dataset:"production",useCdn:!0}),A=[],P=function e(){var t=Math.floor(100001*Math.random());return A.includes(t)?e():(A.push(t),t)},R=function(e){for(var t=[],a=0;a<e.length;a++){for(var n=e[a],r={_key:P(),slug:n.slug,name:n.name,samples:[]},c=0;c<n.packs.length;c++)for(var l=n.packs[c],s=0;s<l.samples.length;s++){var o=l.samples[s];if(o.file){var i={_key:P(),slug:o.slug,name:o.name,pack:l.name,active:!0,file:o.file.asset._ref.replace("file-","https://cdn.sanity.io/files/d5o9qdi6/production/").replace("-mp3",".mp3").replace("-wav",".wav"),effects:[{_unique:236472,name:"delay",test:1,properties:{_unique:236472,delayTime:0,wet:0,feedback:0}}]};r.samples.push(i)}}t.push(r)}return t},J=function(e){var t={loops:[]};return t.cueLoop={_key:P(),isLooping:!1,loopTime:null,loopRestarted:null},t.functions={mutateObject:g},t.settings={categories:R(e)},t};var B=document.getElementById("root");m.a.render(o.a.createElement(function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],i=Object(s.useState)([]),m=Object(l.a)(i,2),u=m[0],p=m[1],f=function(){var e=Object(c.a)(r.a.mark(function e(){var t,a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={currentCategory:null},a=[],e.next=6,F.fetch('\n      *[_type == "category"] {\n        "slug": slug.current,\n        "name": title,\n      }\n    ').then(function(e){return e?function(){var n=Object(c.a)(r.a.mark(function n(){var c,l;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:c=r.a.mark(function n(c){var l;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.currentCategory=e[c].name,l={slug:e[c].slug,name:e[c].name,packs:null},n.next=4,F.fetch('\n      *[_type == "pack"] {\n        "slug": slug.current,\n        "name": title,\n        "samples": *[_type == "sample" && references(*[_type=="category" && title == $currentCategory]._id) && references(^._id)] {\n          "slug": slug.current,\n          "name": title,\n          ...,\n        }\n      }\n    ',t).then(function(e){e?l.packs=e:console.warn("Error retrieving pack")});case 4:a.push(l);case 5:case"end":return n.stop()}},n)}),l=0;case 2:if(!(l<e.length)){n.next=7;break}return n.delegateYield(c(l),"t0",4);case 4:l++,n.next=2;break;case 7:return n.abrupt("return",a);case 8:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}()():null});case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)(function(){Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.t0=p,e.next=4,f();case 4:e.t1=e.sent,(0,e.t0)(e.t1),n(!1);case 7:case"end":return e.stop()}},e)}))()},[]),a?o.a.createElement("div",null,"Fetching data...."):!!u.length&&o.a.createElement("div",{className:"App"},o.a.createElement(E.Container,null,o.a.createElement(M,{store:J(u)})))},null),B)},61:function(e,t,a){e.exports=a(214)}},[[61,1,2]]]);
//# sourceMappingURL=main.89dd44e9.chunk.js.map